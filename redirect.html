<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Dispatch</title>
</head>
<body>
<script>
  // Read params from Airtable button URL
  const qs = new URLSearchParams(window.location.search);
  const recordId = qs.get("recordId") || "";

  const WEBHOOK_URL = "https://hook.us2.make.com/gkm5jqbityd55m278zfpzxo9q752xjm0";

  const payload = new URLSearchParams();
  if (recordId) payload.set("recordId", recordId);

  const blob = new Blob([payload.toString()], {
    type: "application/x-www-form-urlencoded;charset=UTF-8"
  });
  navigator.sendBeacon(WEBHOOK_URL, blob);

  // Close the tab immediately
  window.close();
</script>
</body>
</html>
